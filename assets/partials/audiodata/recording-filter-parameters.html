<div class="dropdown a2-filters-box"
    dropdown 
    dropdown-append-to-body="true" 
    auto-close="disabled"
    is-open="isOpen">
    <button class="btn btn-block btn-default" dropdown-toggle>
        <i class="fa" ng-class="isOpen ? 'fa-chevron-down' : 'fa-chevron-right'"></i>
        Filters <i class="fa fa-filter"></i>
        <small><em>Filter recordings and save as playlists</em></small> 
    </button>
    <div class="dropdown-form dropdown-menu a2-filters-box-dropdown datepicker" role="menu">
        <div class="a2-filter-row">
            <div class="a2-filter a2-filter-text">
                Range:
            </div>
            <div class="a2-filter">
                <button class="btn btn-default" type="text" 
                    yearpick 
                    min-date="minDate"
                    max-date="controller.params.range.to || maxDate"
                    ng-model="controller.params.range.from">
                    <span ng-hide="controller.params.range.from"> Select Date </span>
                    {{ controller.params.range.from | momentUtc: 'll' }}
                </button>
            </div>
            <div class="a2-filter a2-filter-text">
                <i class="fa fa-long-arrow-right"></i>
            </div>
            <div class="a2-filter">
                <button class="btn btn-default" type="text" 
                    yearpick 
                    min-date="controller.params.range.from || minDate"
                    max-date="maxDate"
                    ng-model="controller.params.range.to">
                    <span ng-hide="controller.params.range.to"> Select Date </span>
                    {{ controller.params.range.to | momentUtc: 'll' }}
                </button>
            </div>
        </div>
        <div class="a2-filter-row">
            <div class="a2-filter a2-filter-text">
                Sites:
            </div>
            <div class="a2-filter">
                <ui-select multiple ng-model="controller.params.sites" theme="bootstrap" style="width: 300px;">
                    <ui-select-match placeholder="Site1, Site2, ...">{{$item.value}}</ui-select-match>
                    <ui-select-choices class="has-badges" repeat="item in controller.options.sites | filter:$select.search">
                        {{item.value}} 
                        <span class="badge">{{ item.count }}</span>
                    </ui-select-choices>
                </ui-select>
            </div>
        </div>
        <div class="a2-filter-row">
            <div class="a2-filter a2-filter-text">
                Date and Time:
            </div>
            <div class="a2-filter">
                <ui-select multiple ng-model="controller.params.years" theme="bootstrap" style="width: 125px;">
                    <ui-select-match placeholder="Years...">{{$item.value}}</ui-select-match>
                    <ui-select-choices class="has-badges" repeat="item in controller.options.years | filter:$select.search">
                        {{ item.value }}
                        <span class="badge">{{ item.count }}</span>
                    </ui-select-choices>
                </ui-select>
            </div>
            <div class="a2-filter">
                <ui-select multiple ng-model="controller.params.months" theme="bootstrap" style="width: 125px;">
                    <ui-select-match placeholder="Months...">{{ $item.string }}</ui-select-match>
                    <ui-select-choices class="has-badges" repeat="item in controller.options.months | filter:$select.search">
                        {{ item.string }}
                        <span class="badge">{{ item.count }}</span>
                    </ui-select-choices>
                </ui-select>
            </div>
            <div class="a2-filter">
                <ui-select multiple ng-model="controller.params.days" theme="bootstrap" style="width: 125px;">
                    <ui-select-match placeholder="Days...">{{ $item.value }}</ui-select-match>
                    <ui-select-choices class="has-badges" repeat="item in controller.options.days | filter:$select.search">
                        {{ item.value }}
                        <span class="badge">{{ item.count }}</span>
                    </ui-select-choices>
                </ui-select>
            </div>
            <div class="a2-filter">
                <ui-select multiple ng-model="controller.params.hours" theme="bootstrap" style="width: 125px;">
                    <ui-select-match placeholder="Hours...">{{ $item.string }}</ui-select-match>
                    <ui-select-choices class="has-badges" repeat="item in controller.options.hours | filter:$select.search">
                        {{ item.string }}
                        <span class="badge">{{ item.count }}</span>
                    </ui-select-choices>
                </ui-select>
            </div>
        </div>
        <div class="a2-filter-row">
            <div class="a2-filter a2-filter-text">
                Validations:
            </div>
            <div class="a2-filter">
                <ui-select multiple ng-model="controller.params.validations" theme="bootstrap" style="width: 400px;">
                    <ui-select-match placeholder="Species - Sound...">
                        {{$item.species_name}} - {{$item.songtype_name}} 
                    </ui-select-match>
                    <ui-select-choices class="has-badges" repeat="item in controller.options.classes | filter:$select.search">
                        {{item.species_name }} - {{ item.songtype_name }} 
                        <span class="badge">
                            <i class="fa val-1"></i> {{ item.vals_present }} / 
                            <i class="fa val-0"></i> {{ item.vals_absent }}
                        </span>
                    </ui-select-choices>
                </ui-select>
            </div>
            <div class="a2-filter">
                <ui-select multiple ng-model="controller.params.presence" theme="bootstrap" style="width: 150px;">
                    <ui-select-match allow-clear="true" placeholder="validation">
                        <i ng-class="'fa a2-' + $item"></i> {{ $item | wordCaps}}
                    </ui-select-match>
                    <ui-select-choices class="has-badges" repeat="item in controller.options.presence | filter:$select.search">
                        <i ng-class="'fa a2-' + item"></i> {{ item | wordCaps}}
                    </ui-select-choices>
                </ui-select>
            </div>
        </div>
        <div class="a2-filter-row">
            <div class="a2-filter a2-filter-text">
                Classifications:
            </div>
            <div class="a2-filter">
                <ui-select multiple ng-model="controller.params.classifications" ng-change="controller.computeClassificationResultsOptions(controller.params.classifications)" theme="bootstrap" style="width: 350px;">
                    <ui-select-match placeholder="Classifications...">
                        {{$item.name}} - {{$item.date | moment : 'lll' }} 
                    </ui-select-match>
                    <ui-select-choices class="has-badges" repeat="item in controller.options.classifications | filter:$select.search">
                        {{item.name }} - {{ item.date | moment : 'lll' }} 
                    </ui-select-choices>
                </ui-select>
            </div>
            <div class="a2-filter">
                <ui-select multiple ng-model="controller.params.classification_results" theme="bootstrap" style="width: 150px;">
                    <ui-select-match placeholder="results">
                        <span ng-bind-html="$item.caption" tooltip="{{$item.tooltip}}" tooltip-append-to-body="true"></span>
                    </ui-select-match>
                    <ui-select-choices class="has-badges" repeat="item in controller.options.classification_results | filter:$select.search">
                        <span ng-bind-html="item.caption" tooltip="{{item.tooltip}}" tooltip-append-to-body="true"></span>
                    </ui-select-choices>
                </ui-select>
            </div>
        </div>
        <div class="a2-filter-row">
            <div class="a2-filter a2-filter-text">
                Soundscape Composition:
            </div>
            <div class="a2-filter">
                <ui-select multiple ng-model="controller.params.soundscape_composition" theme="bootstrap" style="width: 300px;">
                    <ui-select-match placeholder="Audio Classes...">
                        {{$item.type}}/{{$item.name}} 
                    </ui-select-match>
                    <ui-select-choices class="has-badges" repeat="item in controller.options.soundscape_composition | filter:$select.search" group-by="'type'">
                        {{item.name }}
                    </ui-select-choices>
                </ui-select>
            </div>
            <div class="a2-filter">
                <ui-select multiple ng-model="controller.params.soundscape_composition_annotation" theme="bootstrap" style="width: 150px;">
                    <ui-select-match allow-clear="true" placeholder="annotation">
                        <i ng-class="'fa a2-' + $item"></i> {{ $item | wordCaps}}
                    </ui-select-match>
                    <ui-select-choices class="has-badges" repeat="item in controller.options.soundscape_composition_annotation | filter:$select.search">
                        <i ng-class="'fa a2-' + item"></i> {{ item | wordCaps}}
                    </ui-select-choices>
                </ui-select>
            </div>
        </div>
        <div class="a2-filter-row">
            <div class="a2-filter a2-filter-text">
                Tags:
            </div>
            <div class="a2-filter">
                <ui-select multiple ng-model="controller.params.tags" theme="bootstrap" style="width: 350px;">
                    <ui-select-match placeholder="Tags...">
                        <a2-tag tag="$item"></a2-tag>
                        <span class="badge">{{ $item.count }}</span>
                    </ui-select-match>
                    <ui-select-choices class="has-badges" repeat="$item in controller.options.tags | filter:$select.search">
                        <a2-tag tag="$item"></a2-tag>
                        <span class="badge">{{ $item.count }}</span>
                    </ui-select-choices>
                </ui-select>
            </div>
        </div>
        <div class="a2-filter-row">
            <button class="btn btn-default" ng-click="applyFilters() | trackEvent:'Audiodata-Recordings':'applyFilters'">
                Apply filters
            </button>
            <button class="btn btn-default" ng-click="resetFilters() | trackEvent:'Audiodata-Recordings':'resetFilters'">
                <i class="fa fa-undo"></i> Reset
            </button>
            <button class="btn btn-default" 
                ng-click="createPlaylist() | trackEvent:'Audiodata-Recordings':'createPlaylist'" 
                tooltip="Save filtered results as playlist"
                tooltip-trigger="mouseenter">
                <i class="fa fa-list-alt"></i>
            </button>
        </div>
    </div>
</div>
