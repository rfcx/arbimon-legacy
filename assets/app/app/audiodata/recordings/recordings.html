<div class="row">
    <div class="col-sm-12 toolbar">
        <span class="dropdown a2-filters-box" dropdown  dropdown-append-to-body="true" a2-auto-close-on-outside-click>
            <button class="btn btn-default" dropdown-toggle ng-disabled="loading"><i class="fa fa-filter"></i> Filters <i class="fa fa-caret-down"></i></button>
            <div class="dropdown-form dropdown-menu a2-filters-box-dropdown datepicker" role="menu">
                <recording-filter-parameters on-apply-filters="controller.applyFilters(filters)" on-create-playlist="controller.createPlaylist(filters)"
                    max-date="maxDate" min-date="minDate" rec-total="totalRecs" is-loading="loading"
                ></recording-filter-parameters>
            </div>
        </span>


        <div class="btn-group padding-left" dropdown dropdown-append-to-body="true" a2-auto-close-on-outside-click>
            <button class="btn btn-default" dropdown-toggle ng-disabled="loading || !controller.exportPermit()"><i class="fa fa-send-o"></i> Export <i class="fa fa-caret-down"></i></button>
            <div class="dropdown-form dropdown-menu" role="menu">
                <recording-data-export-parameters on-export="controller.exportRecordings(parameters)"
                ></recording-data-export-parameters>
            </div>
        </div>

        <div class="btn-group padding-left">
            <button class="btn btn-default"
                ng-click="controller.createPlaylist() | trackEvent:'Audiodata-Recordings':'createPlaylist'"
                tooltip="Save filtered results as playlist"
                tooltip-trigger="mouseenter" ng-disabled="loading">
                <i class="fa fa-list-alt"></i> Save to Playlist
            </button>
        </div>

        <div class="btn-group padding-left" dropdown dropdown-append-to-body="true" a2-auto-close-on-outside-click>
            <button class="btn btn-default" dropdown-toggle ng-disabled="loading">
                <i class="fa fa-trash"></i> Delete <i class="fa fa-caret-down"></i></button>
            </button>
            <ul class="dropdown-form dropdown-menu" role="menu">
                <li class="cs-pointer" ng-class="{ disabled: !checkedRec.length }">
                    <a ng-click="controller.deleteRecordings()">
                        Checked recordings
                    </a>
                </li>
                <li class="cs-pointer" ng-class="{ disabled: !recs.length }">
                    <a ng-click="controller.deleteAllRecordings()">
                        All filtered recordings
                    </a>
                </li>
            </ul>
        </div>
    </div>
</div>
<div class="row reclist-wrapper">
    <div ng-if="totalRecs !== undefined" class="col-sm-4 reclist-total text-left">{{ totalRecs }} Recordings</div>
    <div class="col-sm-4 reclist-pagelimit text-right">
        <div class="btn-group">
            <button class="btn btn-default btn-sm" ng-model="limitPerPage" ng-change="controller.setLimitPerPage(limitPerPage)" btn-radio="10" ng-disabled="loading">10</button>
            <button class="btn btn-default btn-sm" ng-model="limitPerPage" ng-change="controller.setLimitPerPage(limitPerPage)" btn-radio="25" ng-disabled="loading">25</button>
            <button class="btn btn-default btn-sm" ng-model="limitPerPage" ng-change="controller.setLimitPerPage(limitPerPage)" btn-radio="50" ng-disabled="loading">50</button>
            <button class="btn btn-default btn-sm" ng-model="limitPerPage" ng-change="controller.setLimitPerPage(limitPerPage)" btn-radio="100" ng-disabled="loading">100</button>
        </div>
        <button class="btn btn-default btn-sm" tooltip="Reload list" ng-click="controller.reloadList()" ng-disabled="loading">
            <i class="fa fa-refresh"></i>
        </button>
    </div>
</div>
<div class="row">
    <div class="col-sm-12">
        <a2-table rows="recs" data-checked="checked" on-check="selectRec(row)" ext-sort="controller.sortRecs(sortBy, reverse)" default-sort="site">
            <field title="Site" key="site" tdclass="hidelongtext widthtd">
                <span title="{{ row.site }}">{{ row.site }}</span>
            </field>
            <field title="Recorded Time" key="datetime" >{{ (row.datetime | momentUtc : 'YYYY-MM-DD HH:mm:ss') }}</field>
            <field title="Filename" key="file" tdclass="hidelongtext widthtd">
              <span title="{{ row.filename? row.filename : row.file }}">{{ row.filename? row.filename : row.file }}</span>
            </field>
            <field title="Uploaded Time" key="upload_time" >{{ (row.upload_time | momentTz : 'YYYY-MM-DD HH:mm:ss' : row.timezone) }}</field>
            <field title="Recorder" key="recorder">{{ row.recorder }}</field>
            <field title="Comments" key="comments" tdclass="comments hidelongtext seconds-div-center widthtd">
                <span ng-if="row.comments && ['AudioMoth', 'Song Meter', 'SongMeter'].includes(row.recorder)" title="{{row.comments}}">{{row.comments}}</span>
                <span ng-if="!['AudioMoth', 'Song Meter', 'SongMeter'].includes(row.recorder) && row.mic !== 'Unknown' && row.version !== 'Unknown'" title="{{ 'Microphone: ' + row.mic + ' / ' +  'Software: ' + row.version }}">{{ 'Microphone: ' + row.mic + ' / ' +  'Software: ' + row.version }}</span>
            </field>
            <expand-select>
                <div class="recording-img" style="position:relative;">
                    <div style="position:absolute;z-index:10;left:45%;top: 45%">
                        <i class="fa fa-spinner fa-spin" style="font-size: 28px;"></i>
                    </div>
                    <img id="row-{{selected.id}}" style="position:absolute;z-index:100;left:0;width: 420px;" custom-src="{{selected.thumbnail}}"/>
                </div>
                <a class="mt-2 btn btn-default btn-xs" ui-sref="visualizer.view({type:'rec', idA:selected.id})">
                    <i class="fa fa-cubes"></i> View in Visualizer
                </a>
            </expand-select>
        </a2-table>
        <loader ng-hide="!loading"></loader>
    </div>
</div>
<div class="row col-sm-12" ng-if="totalRecs">
    <div class="row-flex flex-align-middle flex-space-start">
        <pagination total-items="totalRecs"
            ng-model="currentPage" ng-change="controller.setCurrentPage(currentPage)"
            class="pagination-sm mr-4"
            boundary-links="true"
            max-size="10"
            rotate="false"
            num-pages="totalPages"
            ng-disabled="loading"
            items-per-page="limitPerPage">
        </pagination>
        <div>
            <label class="mr-2">Jump to page:</label>
            <input id="currentPage" class="form-control page-selector" style="text-align:left;" min="1" step="1" max="totalPages" ng-change="controller.setCurrentPage(currentPage)" ng-model="currentPage" type="number"/>
        </div>
    </div>
</div>
<div class="jumbotron" ng-show="(!recs || !recs.length) && !loading">
    <h3 class="text-center">
        Recordings not found
    </h3>
</div>
