<div class="row">
    <div class="col-md-7">


<div class="row">
    <div class="col-md-push-6 col-md-6 toolbar">
        <input class="form-control" type="text" placeholder="Search" ng-model="search">
    </div>
    <div class="col-md-6 col-md-pull-6 toolbar">
        <button class="btn btn-default"
            ng-click="create() | trackEvent:'Dashboard-sites':'add site'">
            Create
        </button>
        <button class="btn btn-default btn-file" ng-click="importSite()">
            Import
        </button>

        <!-- <div class="btn-group" dropdown>
            <button class="btn btn-default dropdown-toggle"
                id="addsite"
                aria-expanded="true"
                dropdown-toggle>
                <i class="fa fa-plus"></i>
            </button>
            <ul class="dropdown-menu" role="menu" aria-labelledby="addsite">
                <li role="presentation">
                    <a role="menuitem" tabindex="-1" ng-click="create() | trackEvent:'Dashboard-sites':'add site'" ></a>
                </li>
                <li role="presentation">
                    <a role="menuitem" tabindex="-1" ng-click="browseShared()">Add from published sites</a>
                </li>
            </ul>
        </div> -->
        <button class="btn btn-default"
            ng-click="edit() | trackEvent:'Dashboard-sites':'edit site'"
            ng-disabled="!selected || selected.imported">
            Edit
        </button>
        <button class="btn btn-default"
            ng-click="site_token()"
            ng-disabled="!selected || selected.imported">
            Link
        </button>
        <button class="btn btn-default"
            ng-click="del()"
            ng-disabled="!selected">
            Delete
        </button>
    </div>
</div>
<div class="row sites">
    <div ng-class="editing || creating ? 'visible-md-block visible-lg-block' : '' ">
        <a2-table rows="sites" on-select="sel(row)" data-checked="checked" search="search" no-checkbox>
            <field title="Name" key="name" className="name">
                {{ row.name }}
            </field>
            <ng-container ng-if="!row.imported && (row.has_logs || row.token_created_on)">
                <field>
                    <i ng-if="row.has_logs" class="fa fa-book" title="Has status logs"></i>
                    <i ng-if="row.token_created_on" class="fa fa-link" title="Has a Token"></i>
                </field>
            </ng-container>
            <field title="No. of recordings" key="rec_count">
                {{ row.rec_count }}
            </field>
            <field title="Latitude" key="lat">
                {{ row.lat | number:3 }}
            </field>
            <field title="Longitude" key="lon">
                {{ row.lon | number:3 }}
            </field>
            <field title="Altitude" key="alt">
                {{ row.alt | number:2 }}
            </field>
        </a2-table>
        <div class="jumbotron" ng-show="(!sites || !sites.length > 0) && !loading">
            <h3 class="text-center">
                This project does not have any <i class="fa fa-map-marker"></i> sites
            </h3>
        </div>
        <loader ng-hide="!loading"></loader>
    </div>
</div>

</div>
<div class="col-md-5">
    <ul class="nav nav-tabs">
        <li class="ng-isolate-scope" ng-class="{active:show.map}">
            <a ng-click="set_show('map')" href="">
                <i ng-class="editing ? 'fa fa-pencil' : (creating ? 'fa fa-plus' : 'fa fa-map')"></i>
                {{editing ? 'Edit Site' : (creating ? 'New Site' : 'Location')}}
            </a>
        </li>
        <li class="ng-isolate-scope" ng-class="{active:show.status, disabled:!selected.has_logs || creating}">
            <a ng-click="set_show('status')" href="">
                <i class="fa fa-line-chart"></i> Status
            </a>
        </li>
    </ul>
    <div ng-show="editing || creating" class="panel panel-default">
        <div class="panel-body">
            <form class="form" ng-submit="save() | trackEvent:'Dashboard-sites':'save site'" name="siteForm">
                <div class="form-group">
                    <label>Name:</label>
                    <input class="form-control" type="text" ng-model="temp.name" placeholder="Site name" required>
                </div>
                <!-- <div class="checkbox">
                    <label>
                        <input type="checkbox" ng-model="temp.published">
                        publish site
                        <i class="text-info fa fa-info-circle"
                            tooltip-placement="right"
                            tooltip="when this option is checked, the site recordings become available to use in other projects"></i>
                    </label>
                </div> -->
                <div class="form-group">
                    <label>Location:</label>
                    <div class="input-group">
                        <span class="input-group-addon">Lat</span>
                        <input class="form-control"
                            name="lat"
                            type="text"
                            ng-model="temp.lat"
                            placeholder="Latitude"
                            pattern="^-?\d+\.?\d*$"
                            required>
                    </div>
                </div>
                <div class="form-group">
                    <div class="input-group">
                        <span class="input-group-addon">Lon</span>
                        <input class="form-control"
                            name="lon"
                            type="text"
                            ng-model="temp.lon"
                            placeholder="Longitude"
                            pattern="^-?\d+\.?\d*$"
                            required>
                    </div>
                </div>
                <div class="form-group">
                    <div class="input-group">
                        <span class="input-group-addon">Alt</span>
                        <input class="form-control"
                            name="alt"
                            type="text"
                            ng-model="temp.alt"
                            placeholder="Altitude"
                            pattern="^-?\d+\.?\d*$"
                            required>
                    </div>
                </div>
                <div ng-if="editing" class="form-group">
                    <div class="input-group" style="width: 100%;">
                        <label>Project:</label>
                        <ui-select ng-model="temp.project" theme="bootstrap"
                            on-select="onSelect($select.selected)">
                            <ui-select-match class="edit-site-dropdown" placeholder="Project">{{$select.selected.name}}</ui-select-match>
                            <ui-select-choices repeat="project in projects | filter:$select.search">
                                {{project.name}}
                            </ui-select-choices>
                        </ui-select>
                    </div>
                </div>
                <button class="btn btn-primary">
                    <i class="fa fa-floppy-o"></i> Save
                </button>
                <button class="btn btn-default"
                    type="button"
                    ng-click="close() | trackEvent:'Dashboard-sites':'close site edit create'">
                    <i class="fa fa-times"></i> Close
                </button>
            </form>
        </div>
    </div>
    <div class="a2-filter-row" ng-show="show.status">
        <div class="a2-filter a2-filter-text toolbar">
            <div class="col-sm-4">
                <ui-select ng-model="status_controller.selected.series" theme="bootstrap" style="width: 150px;" append-to-body="true"
                ng-change="status_controller.set_series(status_controller.selected.series) | trackEvent:'Audiodata-Site-Status':'set series'" >
                    <ui-select-match placeholder="Series">
                        <i ng-class="$select.selected.icon"></i>
                        {{$select.selected.name}}
                    </ui-select-match>
                    <ui-select-choices repeat="series in status_controller.data.series | filter:$select.search" group-by="status_controller.itemGroup">
                        <i ng-class="series.icon"></i>
                        {{series.name}}
                    </ui-select-choices>
                </ui-select>
            </div>
            <div class="col-sm-4">
                <ui-select ng-model="status_controller.selected.time_range" theme="bootstrap" style="width: 150px;" append-to-body="true"
                ng-change="status_controller.set_time_range(status_controller.selected.time_range) | trackEvent:'Audiodata-Site-Status':'set time range'" >
                    <ui-select-match placeholder="View">
                        <i class="fa fa-clock-o"></i>
                        {{$select.selected.text}}
                    </ui-select-match>
                    <ui-select-choices repeat="time_range in status_controller.data.time_ranges | filter:$select.search" group-by="status_controller.itemGroup">
                        {{time_range.text}}
                    </ui-select-choices>
                </ui-select>
            </div>
            <div class="col-sm-4">
                <ui-select ng-model="status_controller.selected.period" theme="bootstrap" style="width: 150px;" append-to-body="true"
                ng-change="status_controller.set_period(status_controller.selected.period) | trackEvent:'Audiodata-Site-Status':'set period'" >
                    <ui-select-match placeholder="Detail">
                        <i class="fa fa-hourglass-3"></i>
                        {{$select.selected.text}}
                    </ui-select-match>
                    <ui-select-choices repeat="period in status_controller.data.periods | filter:$select.search" group-by="status_controller.itemGroup">
                        {{period.text}}
                    </ui-select-choices>
                </ui-select>
            </div>
        </div>
        <div class="chart-container">
            <loader class="block" ng-hide="!status_controller.loading.data" text="Loading {{status_controller.selected.series.name}} Data"></loader>
            <c3-chart-display data="status_controller.chart.data" axes="status_controller.chart.axes"></c3-chart-display>
        </div>
    </div>
    <div class="panel" ng-show="show.map">
        <div class="map" id="map-site"></div>
    </div>
</div>
</div>
