<div>
    <div ng-if="controller.loading.details">
        Loading <loader></loader>
    </div>
    <div ng-if="!controller.loading.details">
        <div class="panel-body" ng-show="controller.patternMatching">
            <div class="row row-flex flex-align-middle">
                <div class="col-sm-2 flex-self-align-top">
                    <button class="btn btn-default"
                        ng-click="onGoBack({}) | trackEvent:'Analysis-Pattern-Matching-List':' go back'">
                        &lt;  Go Back
                    </button>
                </div>
                <div class="col-sm-2" style="padding-bottom:5px">
                    <div class="roi-thumbnail" >
                        <img ng-src="{{controller.patternMatching.template.uri}}" class="roi-img"/>
                        <a class="roi-btn-br" ng-href="{{controller.getTemplateVisualizerUrl(controller.patternMatching.template)}}">
                            <i tooltip-placement="left"
                                tooltip-append-to-body="true"
                                tooltip="View in Visualizer"
                                class="fa fa-cubes">
                            </i>
                        </a>
                    </div>
                </div>
                <div class="col-sm-5 is-v-middle">
                    {{controller.patternMatching.name}}<br />
                    {{controller.patternMatching.species_name }}, {{controller.patternMatching.songtype_name }}<br />
                    {{controller.patternMatching.timestamp | moment : 'lll' }}<br />
                    {{controller.patternMatching.playlist_name}}<br />
                    {{controller.patternMatching.parameters}}<br />
                    {{controller.patternMatching.matches}} matches ({{controller.patternMatching.validated}} validated)
                </div>
                <div class="col-sm-5 flex-self-align-bottom">
                    <div class="toolbar pull-right">
                        <div class="btn-group" ng-show="controller.total.pages > 1 || detailedView">
                            <a class="btn btn-default" ng-click="controller.prev() | trackEvent:'Pattern Matching Details':'prevPage'">Previous</a>
                            <a class="btn btn-default" ng-hide="detailedView">{{controller.selected.page + 1}} of {{controller.total.pages}}</a>
                            <a class="btn btn-default" ng-show="detailedView">{{controller.selected.roi_index + 1}} of {{controller.total.rois}}</a>
                            <a class="btn btn-default" ng-click="controller.next() | trackEvent:'Pattern Matching Details':'nextPage'">Next</a>
                        </div>

                        <div class="btn-group">
                                <a class="btn btn-default"
                                ng-href="{{controller.selected.trainingSet.export_url}}"
                                ng-click="true | trackEvent:'Pattern Matching Details':'export'"
                                ng-disabled="!controller.selected.trainingSet"
                                tooltip="Export Training Set Data">
                                <i class="fa fa-download"></i>
                            </a>
                        </div>
                    </div>
                </div>
            </div>
            <div ng-show="loading-rois">Loading...</div>
            <div>
                <div ng-repeat="roi in controller.rois"
                    class="btn btn-default roi-thumbnail {{roi.selected ? 'active' : ''}}"
                    ng-click="roi.selected = !roi.selected"
                    popover-html="'Duration: {{roi.x2 - roi.x1 | number:2}}s <br>
                             Bandwidth: {{roi.y2-roi.y1}}Hz <br>
                             Upper freq: {{roi.y2}}Hz <br>
                             Lower freq: {{roi.y1}}Hz'"
                    popover-trigger="mouseenter"
                    popover-append-to-body="true"
                >
                    <input class="roi-btn-tl" type="checkbox" ng-model="roi.selected">
                    <div class="roi-btn-cc h1" ng-if="roi.validated !== null">
                        <i class="fa val-{{roi.validated}}"></i>
                    </div>
                    <!-- <div class="roi-btn-tr" >
                        <button ng-click="controller.validate(1, [roi]) | trackEvent:'Pattern Matching Details':'validate roi'"
                            class="btn btn-clear"
                            tooltip-placement="left"
                            tooltip-append-to-body="true"
                            tooltip="Correct Match">
                            <i class="fa val-1"></i>
                        </button>
                        <button ng-click="controller.validate(0, [roi]) | trackEvent:'Pattern Matching Details':'validate roi'"
                            class="btn btn-clear"
                            tooltip-placement="left"
                            tooltip-append-to-body="true"
                            tooltip="Wrong Match">
                            <i class="fa val-0"></i>
                        </button>
                    </div> -->
                    <a class="roi-btn-br" ng-href="{{controller.getRoiVisualizerUrl(roi)}}">
                        <i tooltip-placement="left"
                            tooltip-append-to-body="true"
                            tooltip="View in Visualizer"
                            class="fa fa-cubes">
                        </i>
                    </a>
                    <img ng-src="{{ roi.uri }}" class="roi-img"/>
                </div>
            </div>
        </div>
        <div class="panel-body" ng-show="controller.patternMatching">
            <div class="row">

                <div class="col-sm-11" >
                    <div class="toolbar pull-right">
                        <div class="btn-group">
                            <button class="btn btn-default" >Select :</button>
                            <button class="btn btn-default" ng-click="controller.select('all')">All</button>
                            <button class="btn btn-default" ng-click="controller.select('none')">None</button>
                            <button class="btn btn-default" ng-click="controller.select('not-validated')">Not Validated</button>
                        </div>

                        <div class="btn-group">
                            <button class="btn btn-default" >Validate Selected as :</button>
                            <button class="btn btn-default" ng-click="controller.validate(1)"><i class="fa val-1"></i> Correct</button>
                            <button class="btn btn-default" ng-click="controller.validate(0)"><i class="fa val-0"></i> Wrong</button>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

</div>
